
# Руководство по Tetris

## Введение

Это руководство для игры Tetris, разработанной на языке C с использованием библиотеки `ncurses` для создания консольного интерфейса. Проект включает саму игру, тесты, отчёт о покрытии кода и документацию.

## Описание игры

Tetris — классическая игра, в которой игроку нужно управлять падающими фигурами (тетрамино), чтобы складывать их в горизонтальные линии. Когда линия заполняется полностью, она исчезает, и игрок получает очки. Игра заканчивается, если фигуры достигают верхней части игрового поля.

### Основные особенности

- **Консольный интерфейс:** Игра реализована с использованием библиотеки `ncurses`, что позволяет отображать игровое поле и фигуры в терминале.
- **Управление:** Используются стрелки клавиатуры для перемещения фигур и другие клавиши для дополнительных действий.
- **Сохранение рекордов:** Игра сохраняет лучший результат игрока.

## Требования

- **Операционная система:** Linux (например, Ubuntu в WSL) или macOS.
- **Компилятор:** GCC.
- **Библиотеки:** `ncurses` (для интерфейса), `check` (для тестов на Linux), `libm` (на macOS).

## Установка

1. Убедитесь, что у вас установлены необходимые зависимости:
   - На Ubuntu:

     `sudo apt update`
     `sudo apt install libncurses5-dev libncursesw5-dev check`

   - На macOS:
     `brew install ncurses check`
2. Склонируйте или распакуйте проект:

    `tar -xzf tetris_dist.tar.gz`

3. Выполните сборку и установку:

    `make`
    `make install`

## Управление

- Стрелка влево/A: Перемещение фигуры влево
- Стрелка вправо/D: Перемещение фигуры вправо.
- Стрелка вниз/S: Ускорение падения фигуры.
- Стрелка вверх/W: Поворот фигуры.
- P: пауза.
- Q: Выход из игры.

## Запуск игры

 После установки запустите игру:


`./tetris`

## Структура проекта

- **brick_game/tetris/**: Основная логика игры (brick_game_tetris.c).
- **gui/cli/**: Консольный интерфейс (cli.c, gui.c).
- **brick_game/tests/**: Тесты для игры (test_brick_game_tetris.c).
- **doc/**: Документация (tetris_manual.md).

## Тестирование

Проект включает в себя юнит-тесты для проверки логики игры.

1. Запустите тесты:

  `make test`
  
2. Сгенерируйте отчет о покрытии кода:

 `make gcov_report`

 Отчет откроется в браузере (файл ``gcov_report/index.html``).

## Дополнительные команды

- **Очистка:** Удаление временных файлов и сборки.

    `make clean`

- **Удаление:** Удаление установленной игры.

    `make uninstall`

- **Проверка стиля кода:**

    `make style`

- **Проверка на утечки памяти:**

    `make test_valgrind`

## Диаграмма КА (конечного автомата)

![Диаграмма конечного автомата](fsm_diagram.png)

#### Состояния игры

- **Start:** Начальное состояние, отображение стартового экрана.
- **Moving:** Движение фигуры (игрок управляет текущей фигурой).
- **Shifting:** Падение фигуры вниз.
- **Attaching:** Присоединение фигуры к игровому полю.
- **Game Over:** Игра завершена, отображение финального счёта.

#### Переходы

- Из **Start** в **Moving**: Нажатие клавиши "Старт".
- Из **Moving** в **Shifting**: Автоматическое падение фигуры по таймеру.
- Из **Shifting** в **Attaching**: Фигура достигла низа или другой фигуры.
- Из **Attaching** в **Moving**: Новая фигура появляется.
- Из **Attaching** в **Game Over**: Игровое поле заполнено.
- Из **Game Over** в **Start**: Нажатие клавиши "Рестарт".

## Заключение

Этот Tetris — учебный проект, демонстрирующий использование языка C, библиотеки ncurses и автоматизированного тестирования.
При выполнении проекта были задействованы и усовершенствованы навыки структурного программирования, работа с алгоритмами, а также базовое представление об архитектуре программного обеспечения и связи между интерфейсом и бэкендом.
Игра проста в установке и использовании, а также предоставляет инструменты для проверки качества кода, такие как cppcheck, valgrind.
